# The modernization of propaganda: how The Chinese Communist Youth League (CYL) try to talk to the younger generation by engaging popular culture Code Repository

## `src` directory

Code in `src` directory is the source code to generate `.xlsx`, `.json` and `.html` file.

`allToJson.py` collect all video information of BiliBili user 共青团中央 and save to json file [video.json](./assert/video.json) through [API](https://api.bilibili.com/x/space/arc/search?mid=20165629&ps=30&tid=0&pn=1&keyword=&order=pubdate&jsonp=jsonp")

`cleanJson.py` clean json file, remove some useless information in json.

`sampleJson.py` sample json file `video.json`, sample 70 video information which uniform distributed on weekdays, 10 video each weekday. Save to [sample.json](./assert/sample.json).

`jsonToXlsx.py` get video information from json file [sample.json](./assert/sample.json) and save to [sample.xlsx](./assert/sample.xlsx), which contains image information.

`jsonTohtml.py` get video information from json file [sample.json](./assert/sample.json) and save to [sample.html](./assert/sample.html), which contains image information.

## `assert` directory

This directory contains all the files generated by the program, which are source file to analysis.

`video.xlsx` is all video information of BiliBili user 共青团中央 util 2022/03/22.

`video.json` is all video information of BiliBili user 共青团中央 util 2022/03/22.

`coding_sheet.xlsx` is `video.xlsx` after a few cleaning.

`sample.json` contains 70 sampled videos information from `video.json`.

`sampleLite.json` contains 70 sampled videos after remove useless information from `video.json`.

`sample.xlsx` contains 70 sampled videos information from `video.xlsx`.

`sample.html` contains 70 sampled videos information from `video.json`, images is a link of origin site (bilibili).

